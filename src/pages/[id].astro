---
import { fetchArticle } from "@lib/api";
import { stripHtml } from "@lib/strip-html";
import Blog from "@layouts/blog";
import { DateBadge } from "@tmp-components/DateBadge"

const { id } = Astro.params;
const draftKey = Astro.url.searchParams.get("draftKey") || "";
const article = await fetchArticle(id, { draftKey });
---

<Blog
	title={article.title}
	description={stripHtml(article.body)}
	img={article?.image.url || null}
>
	<div class="py-6 prose lg:prose-lg">
		{
			article.image && (
				<figure class="flex justify-center">
					<img
						src={article.image.url}
						alt={article.title}
						class="rounded bg-base-200"
					/>
				</figure>
			)
		}
		<h1>{article.title}</h1>
		<div class="flex gap-3">
		<DateBadge date={article.createdAt} />
		</div>
		<main set:html={article.body} />
	</div>
</Blog>
